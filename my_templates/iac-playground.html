<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>IaC Playground | Nick Holmes</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="../css/style.css">
  
  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Fira+Code:wght@400;500;600&display=swap" rel="stylesheet">
  
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  
  <style>
    :root {
      --primary-color: #00d9ff;
      --secondary-color: #a855f7;
      --accent-color: #f59e0b;
      --bg-dark: #0a0a0f;
      --bg-card: #1a1a2e;
      --text-primary: #ffffff;
      --text-secondary: #a0aec0;
      --success: #10b981;
      --danger: #ef4444;
      --aws: #ff9900;
      --azure: #0078d4;
      --gcp: #4285f4;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      background: linear-gradient(135deg, var(--bg-dark) 0%, var(--bg-card) 100%);
      color: var(--text-primary);
      font-family: 'Inter', sans-serif;
      overflow-x: hidden;
    }

    body::before {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: 
        radial-gradient(circle at 20% 50%, rgba(0, 217, 255, 0.05) 0%, transparent 50%),
        radial-gradient(circle at 80% 80%, rgba(168, 85, 247, 0.05) 0%, transparent 50%);
      pointer-events: none;
      z-index: 0;
    }

    header, main {
      position: relative;
      z-index: 1;
    }

    /* Navigation */
    nav ul {
      list-style: none;
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      gap: 10px;
      margin: 0;
      padding: 20px;
      background: rgba(255, 255, 255, 0.03);
      backdrop-filter: blur(20px);
      border-radius: 50px;
      max-width: 1100px;
      margin: 20px auto;
    }

    nav li { margin: 0; }

    nav a {
      color: var(--text-primary);
      text-decoration: none;
      font-weight: 600;
      padding: 10px 18px;
      border-radius: 30px;
      background: rgba(255, 255, 255, 0.05);
      transition: all 0.3s ease;
      font-size: 0.95rem;
      white-space: nowrap;
    }

    nav a:hover, nav a.active {
      background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
      color: white;
      box-shadow: 0 4px 15px rgba(0, 217, 255, 0.3);
      transform: translateY(-2px);
    }

    /* Hero */
    .hero {
      text-align: center;
      padding: 40px 20px 30px;
    }

    .hero h1 {
      font-size: clamp(2rem, 5vw, 3.5rem);
      font-weight: 800;
      background: linear-gradient(135deg, var(--primary-color), var(--secondary-color), var(--accent-color));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      margin-bottom: 10px;
    }

    .hero p {
      font-size: 1.1rem;
      color: var(--text-secondary);
      max-width: 900px;
      margin: 0 auto 20px;
    }

    .badge {
      display: inline-block;
      padding: 6px 16px;
      background: rgba(0, 217, 255, 0.1);
      border: 2px solid var(--primary-color);
      border-radius: 20px;
      color: var(--primary-color);
      font-weight: 600;
      font-size: 0.85rem;
      margin: 3px;
    }

    /* Main Container */
    .container {
      max-width: 1800px;
      margin: 0 auto;
      padding: 0 20px 40px;
    }

    /* Provider Selector */
    .provider-selector {
      display: flex;
      gap: 15px;
      margin-bottom: 25px;
      justify-content: center;
      flex-wrap: wrap;
    }

    .provider-btn {
      padding: 12px 25px;
      background: rgba(255, 255, 255, 0.05);
      border: 2px solid rgba(255, 255, 255, 0.1);
      border-radius: 12px;
      color: var(--text-secondary);
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      font-size: 1rem;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .provider-btn:hover {
      background: rgba(255, 255, 255, 0.08);
      transform: translateY(-2px);
    }

    .provider-btn.active {
      color: white;
    }

    .provider-btn.aws.active {
      background: var(--aws);
      border-color: var(--aws);
      box-shadow: 0 4px 15px rgba(255, 153, 0, 0.3);
    }

    .provider-btn.azure.active {
      background: var(--azure);
      border-color: var(--azure);
      box-shadow: 0 4px 15px rgba(0, 120, 212, 0.3);
    }

    .provider-btn.gcp.active {
      background: var(--gcp);
      border-color: var(--gcp);
      box-shadow: 0 4px 15px rgba(66, 133, 244, 0.3);
    }

    /* Workspace Layout */
    .workspace {
      display: grid;
      grid-template-columns: 280px 1fr 450px;
      gap: 20px;
      margin-bottom: 30px;
    }

    /* Resource Palette */
    .resource-palette {
      background: rgba(255, 255, 255, 0.03);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 15px;
      padding: 20px;
      max-height: 800px;
      overflow-y: auto;
    }

    .palette-title {
      color: var(--primary-color);
      font-weight: 700;
      margin-bottom: 15px;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .resource-category {
      margin-bottom: 20px;
    }

    .category-label {
      color: var(--text-secondary);
      font-size: 0.85rem;
      font-weight: 600;
      text-transform: uppercase;
      margin-bottom: 10px;
      letter-spacing: 1px;
    }

    .resource-item {
      padding: 10px 12px;
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 8px;
      margin-bottom: 8px;
      cursor: grab;
      transition: all 0.3s ease;
      font-size: 0.9rem;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .resource-item:hover {
      background: rgba(0, 217, 255, 0.1);
      border-color: var(--primary-color);
      transform: translateX(5px);
    }

    .resource-item:active {
      cursor: grabbing;
    }

    .resource-icon {
      font-size: 1.2rem;
    }

    /* Canvas Area */
    .canvas-area {
      background: rgba(255, 255, 255, 0.03);
      backdrop-filter: blur(10px);
      border: 2px dashed rgba(255, 255, 255, 0.2);
      border-radius: 15px;
      min-height: 600px;
      position: relative;
      overflow: hidden;
    }

    .canvas-header {
      padding: 15px 20px;
      background: rgba(255, 255, 255, 0.02);
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .canvas-title {
      font-weight: 700;
      color: var(--text-primary);
    }

    .canvas-actions {
      display: flex;
      gap: 10px;
    }

    .icon-btn {
      padding: 6px 12px;
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 6px;
      color: var(--text-secondary);
      cursor: pointer;
      transition: all 0.3s ease;
      font-size: 0.9rem;
    }

    .icon-btn:hover {
      background: rgba(0, 217, 255, 0.1);
      border-color: var(--primary-color);
      color: var(--primary-color);
    }

    #infrastructureCanvas {
      padding: 20px;
      min-height: 500px;
    }

    .dropped-resource {
      position: absolute;
      padding: 15px 20px;
      background: rgba(255, 255, 255, 0.08);
      backdrop-filter: blur(10px);
      border: 2px solid var(--primary-color);
      border-radius: 12px;
      cursor: move;
      box-shadow: 0 4px 15px rgba(0, 217, 255, 0.2);
      min-width: 150px;
    }

    .dropped-resource:hover {
      border-color: var(--secondary-color);
      box-shadow: 0 6px 20px rgba(168, 85, 247, 0.3);
    }

    .resource-title {
      font-weight: 700;
      font-size: 0.9rem;
      margin-bottom: 5px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .resource-type {
      font-size: 0.8rem;
      color: var(--text-secondary);
    }

    .resource-delete {
      position: absolute;
      top: 5px;
      right: 5px;
      width: 24px;
      height: 24px;
      background: var(--danger);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      opacity: 0;
      transition: opacity 0.3s ease;
      font-size: 0.8rem;
    }

    .dropped-resource:hover .resource-delete {
      opacity: 1;
    }

    /* Code Panel */
    .code-panel {
      background: rgba(255, 255, 255, 0.03);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 15px;
      display: flex;
      flex-direction: column;
      max-height: 800px;
    }

    .code-header {
      padding: 15px 20px;
      background: rgba(255, 255, 255, 0.02);
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .code-tabs {
      display: flex;
      gap: 10px;
    }

    .code-tab {
      padding: 6px 15px;
      background: rgba(255, 255, 255, 0.05);
      border-radius: 6px;
      cursor: pointer;
      font-size: 0.85rem;
      transition: all 0.3s ease;
    }

    .code-tab.active {
      background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
      color: white;
    }

    #generatedCode {
      flex: 1;
      background: rgba(10, 10, 15, 0.95);
      padding: 20px;
      overflow-y: auto;
      font-family: 'Fira Code', monospace;
      font-size: 0.85rem;
      line-height: 1.6;
      color: var(--text-primary);
    }

    .btn {
      padding: 10px 20px;
      background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
      border: none;
      border-radius: 8px;
      color: white;
      font-weight: 600;
      font-size: 0.9rem;
      cursor: pointer;
      transition: all 0.3s ease;
      display: inline-flex;
      align-items: center;
      gap: 8px;
    }

    .btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(0, 217, 255, 0.4);
    }

    .btn-secondary {
      background: rgba(255, 255, 255, 0.1);
    }

    /* Dependency Graph */
    .dependency-graph {
      background: rgba(255, 255, 255, 0.03);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 15px;
      padding: 20px;
      margin-top: 20px;
    }

    .graph-title {
      color: var(--primary-color);
      font-weight: 700;
      margin-bottom: 15px;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .graph-canvas {
      width: 100%;
      height: 300px;
      background: rgba(10, 10, 15, 0.5);
      border-radius: 10px;
    }

    @media (max-width: 1400px) {
      .workspace {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <header>
    <nav>
      <h1></h1>
      <ul>
        <li><a href="../index.html">Home</a></li>
        <li><a href="about.html">About</a></li>
        <li><a href="projects.html">Projects</a></li>
        <li><a href="contact.html">Contact</a></li>
        <li><a href="certificates.html">Certificates</a></li>
        <li><a href="services-faq.html">Services FAQ</a></li>
        <li><a href="interactive-showcase.html">Showcase</a></li>
        <li><a href="blog.html">Blog</a></li>
        <li><a href="performance-metrics.html">Performance</a></li>
      </ul>
    </nav>
  </header>

  <section class="hero">
    <h1>‚òÅÔ∏è Infrastructure as Code Playground</h1>
    <p>Visual IaC builder with drag-and-drop cloud resources. Design AWS, Azure, and GCP infrastructure, then generate Terraform/CloudFormation templates with dependency graphs.</p>
    <div>
      <span class="badge">üé® Drag & Drop</span>
      <span class="badge">üì¶ Multi-Cloud</span>
      <span class="badge">üîó Auto-Dependencies</span>
    </div>
  </section>

  <main class="container">
    <!-- Provider Selector -->
    <div class="provider-selector">
      <button class="provider-btn aws active" onclick="selectProvider('aws')">
        <i class="fab fa-aws"></i>
        Amazon Web Services
      </button>
      <button class="provider-btn azure" onclick="selectProvider('azure')">
        <i class="fab fa-microsoft"></i>
        Microsoft Azure
      </button>
      <button class="provider-btn gcp" onclick="selectProvider('gcp')">
        <i class="fab fa-google"></i>
        Google Cloud Platform
      </button>
    </div>

    <!-- Main Workspace -->
    <div class="workspace">
      <!-- Resource Palette -->
      <div class="resource-palette">
        <div class="palette-title">
          <i class="fas fa-cubes"></i>
          Resources
        </div>

        <div id="resourceList">
          <!-- AWS Resources (default) -->
          <div class="resource-category">
            <div class="category-label">Compute</div>
            <div class="resource-item" draggable="true" data-type="ec2">
              <span class="resource-icon">üíª</span>
              <span>EC2 Instance</span>
            </div>
            <div class="resource-item" draggable="true" data-type="lambda">
              <span class="resource-icon">‚ö°</span>
              <span>Lambda Function</span>
            </div>
            <div class="resource-item" draggable="true" data-type="ecs">
              <span class="resource-icon">üê≥</span>
              <span>ECS Container</span>
            </div>
          </div>

          <div class="resource-category">
            <div class="category-label">Storage</div>
            <div class="resource-item" draggable="true" data-type="s3">
              <span class="resource-icon">ü™£</span>
              <span>S3 Bucket</span>
            </div>
            <div class="resource-item" draggable="true" data-type="ebs">
              <span class="resource-icon">üíæ</span>
              <span>EBS Volume</span>
            </div>
            <div class="resource-item" draggable="true" data-type="efs">
              <span class="resource-icon">üìÅ</span>
              <span>EFS File System</span>
            </div>
          </div>

          <div class="resource-category">
            <div class="category-label">Database</div>
            <div class="resource-item" draggable="true" data-type="rds">
              <span class="resource-icon">üóÑÔ∏è</span>
              <span>RDS Database</span>
            </div>
            <div class="resource-item" draggable="true" data-type="dynamodb">
              <span class="resource-icon">‚ö°</span>
              <span>DynamoDB Table</span>
            </div>
          </div>

          <div class="resource-category">
            <div class="category-label">Networking</div>
            <div class="resource-item" draggable="true" data-type="vpc">
              <span class="resource-icon">üåê</span>
              <span>VPC</span>
            </div>
            <div class="resource-item" draggable="true" data-type="elb">
              <span class="resource-icon">‚öñÔ∏è</span>
              <span>Load Balancer</span>
            </div>
            <div class="resource-item" draggable="true" data-type="security-group">
              <span class="resource-icon">üõ°Ô∏è</span>
              <span>Security Group</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Canvas Area -->
      <div class="canvas-area" id="dropZone">
        <div class="canvas-header">
          <div class="canvas-title">Infrastructure Designer</div>
          <div class="canvas-actions">
            <button class="icon-btn" onclick="clearCanvas()" title="Clear All">
              <i class="fas fa-trash"></i>
            </button>
            <button class="icon-btn" onclick="zoomIn()" title="Zoom In">
              <i class="fas fa-search-plus"></i>
            </button>
            <button class="icon-btn" onclick="zoomOut()" title="Zoom Out">
              <i class="fas fa-search-minus"></i>
            </button>
          </div>
        </div>
        <div id="infrastructureCanvas">
          <div style="text-align: center; color: var(--text-secondary); padding: 100px 20px;">
            <i class="fas fa-hand-pointer" style="font-size: 3rem; margin-bottom: 20px; opacity: 0.3;"></i>
            <p>Drag resources from the left palette to start building your infrastructure</p>
          </div>
        </div>
      </div>

      <!-- Code Panel -->
      <div class="code-panel">
        <div class="code-header">
          <div class="code-tabs">
            <div class="code-tab active" onclick="switchTab('terraform')">Terraform</div>
            <div class="code-tab" onclick="switchTab('cloudformation')">CloudFormation</div>
          </div>
          <button class="btn btn-secondary" onclick="copyCode()">
            <i class="fas fa-copy"></i> Copy
          </button>
        </div>
        <pre id="generatedCode"><code># Your infrastructure code will appear here
# Drag resources to the canvas to generate IaC templates

provider "aws" {
  region = "us-east-1"
}

# Resources will be added as you design...
</code></pre>
      </div>
    </div>

    <!-- Dependency Graph -->
    <div class="dependency-graph">
      <div class="graph-title">
        <i class="fas fa-project-diagram"></i>
        Resource Dependency Graph
      </div>
      <canvas class="graph-canvas" id="dependencyGraph"></canvas>
    </div>
  </main>

  <script>
    let currentProvider = 'aws';
    let currentTab = 'terraform';
    let resources = [];
    let resourceCounter = 0;

    const resourceTemplates = {
      aws: {
        ec2: { name: 'EC2 Instance', icon: 'üíª', terraform: 'aws_instance', cloudformation: 'AWS::EC2::Instance' },
        lambda: { name: 'Lambda Function', icon: '‚ö°', terraform: 'aws_lambda_function', cloudformation: 'AWS::Lambda::Function' },
        ecs: { name: 'ECS Container', icon: 'üê≥', terraform: 'aws_ecs_service', cloudformation: 'AWS::ECS::Service' },
        s3: { name: 'S3 Bucket', icon: 'ü™£', terraform: 'aws_s3_bucket', cloudformation: 'AWS::S3::Bucket' },
        ebs: { name: 'EBS Volume', icon: 'üíæ', terraform: 'aws_ebs_volume', cloudformation: 'AWS::EC2::Volume' },
        efs: { name: 'EFS File System', icon: 'üìÅ', terraform: 'aws_efs_file_system', cloudformation: 'AWS::EFS::FileSystem' },
        rds: { name: 'RDS Database', icon: 'üóÑÔ∏è', terraform: 'aws_db_instance', cloudformation: 'AWS::RDS::DBInstance' },
        dynamodb: { name: 'DynamoDB Table', icon: '‚ö°', terraform: 'aws_dynamodb_table', cloudformation: 'AWS::DynamoDB::Table' },
        vpc: { name: 'VPC', icon: 'üåê', terraform: 'aws_vpc', cloudformation: 'AWS::EC2::VPC' },
        elb: { name: 'Load Balancer', icon: '‚öñÔ∏è', terraform: 'aws_lb', cloudformation: 'AWS::ElasticLoadBalancingV2::LoadBalancer' },
        'security-group': { name: 'Security Group', icon: 'üõ°Ô∏è', terraform: 'aws_security_group', cloudformation: 'AWS::EC2::SecurityGroup' }
      }
    };

    function selectProvider(provider) {
      currentProvider = provider;
      document.querySelectorAll('.provider-btn').forEach(btn => btn.classList.remove('active'));
      event.target.classList.add('active');
      updateResourceList();
    }

    function updateResourceList() {
      // In a real app, this would load provider-specific resources
      // For now, we keep AWS resources
    }

    // Drag and Drop functionality
    document.querySelectorAll('.resource-item').forEach(item => {
      item.addEventListener('dragstart', (e) => {
        e.dataTransfer.setData('resourceType', e.target.dataset.type);
      });
    });

    const dropZone = document.getElementById('infrastructureCanvas');
    
    dropZone.addEventListener('dragover', (e) => {
      e.preventDefault();
    });

    dropZone.addEventListener('drop', (e) => {
      e.preventDefault();
      const resourceType = e.dataTransfer.getData('resourceType');
      if (resourceType) {
        const rect = dropZone.getBoundingClientRect();
        const x = e.clientX - rect.left;
        const y = e.clientY - rect.top;
        addResource(resourceType, x, y);
      }
    });

    function addResource(type, x, y) {
      const template = resourceTemplates[currentProvider][type];
      const id = ++resourceCounter;
      
      const resource = {
        id,
        type,
        name: template.name,
        icon: template.icon,
        x,
        y,
        terraform: template.terraform,
        cloudformation: template.cloudformation
      };
      
      resources.push(resource);
      
      // Create visual element
      const element = document.createElement('div');
      element.className = 'dropped-resource';
      element.style.left = x + 'px';
      element.style.top = y + 'px';
      element.innerHTML = `
        <div class="resource-title">
          <span>${template.icon}</span>
          <span>${template.name}</span>
        </div>
        <div class="resource-type">${template.terraform}</div>
        <div class="resource-delete" onclick="removeResource(${id})">
          <i class="fas fa-times"></i>
        </div>
      `;
      
      // Make draggable
      element.draggable = true;
      element.addEventListener('dragstart', (e) => {
        e.dataTransfer.setData('resourceId', id);
      });
      
      dropZone.appendChild(element);
      updateCode();
      updateDependencyGraph();
    }

    function removeResource(id) {
      resources = resources.filter(r => r.id !== id);
      updateCode();
      updateDependencyGraph();
      event.target.closest('.dropped-resource').remove();
    }

    function clearCanvas() {
      resources = [];
      document.querySelectorAll('.dropped-resource').forEach(el => el.remove());
      updateCode();
      updateDependencyGraph();
    }

    function switchTab(tab) {
      currentTab = tab;
      document.querySelectorAll('.code-tab').forEach(t => t.classList.remove('active'));
      event.target.classList.add('active');
      updateCode();
    }

    function updateCode() {
      const codeDisplay = document.getElementById('generatedCode');
      
      if (resources.length === 0) {
        codeDisplay.innerHTML = currentTab === 'terraform' ? 
          `<code># Your infrastructure code will appear here
# Drag resources to the canvas to generate IaC templates

provider "aws" {
  region = "us-east-1"
}

# Resources will be added as you design...
</code>` :
          `<code># CloudFormation Template
AWSTemplateFormatVersion: '2010-09-09'
Description: 'Auto-generated infrastructure template'

Resources:
  # Resources will be added as you design...
</code>`;
        return;
      }
      
      let code = '';
      
      if (currentTab === 'terraform') {
        code = `# Terraform Configuration
# Generated by IaC Playground

terraform {
  required_providers {
    aws = {
      source  = "hashicorp/aws"
      version = "~> 5.0"
    }
  }
}

provider "aws" {
  region = "us-east-1"
}

`;
        resources.forEach((resource, index) => {
          const resourceName = resource.type.replace('-', '_');
          code += `resource "${resource.terraform}" "${resourceName}_${resource.id}" {
  # Configuration for ${resource.name}
  
`;
          
          // Add sample attributes based on resource type
          if (resource.type === 'ec2') {
            code += `  ami           = "ami-0c55b159cbfafe1f0"
  instance_type = "t2.micro"
  
  tags = {
    Name = "${resource.name}-${resource.id}"
  }`;
          } else if (resource.type === 's3') {
            code += `  bucket = "${resourceName}-${resource.id}-bucket"
  
  tags = {
    Name = "${resource.name}-${resource.id}"
  }`;
          } else if (resource.type === 'rds') {
            code += `  allocated_storage    = 20
  engine               = "mysql"
  instance_class       = "db.t3.micro"
  db_name              = "mydb${resource.id}"
  username             = "admin"
  password             = "changeme123"
  skip_final_snapshot  = true`;
          } else if (resource.type === 'lambda') {
            code += `  function_name = "${resourceName}_${resource.id}"
  role          = aws_iam_role.lambda_role.arn
  handler       = "index.handler"
  runtime       = "python3.9"
  
  filename      = "lambda_function.zip"`;
          } else {
            code += `  name = "${resource.name}-${resource.id}"`;
          }
          
          code += `\n}\n\n`;
        });
      } else {
        // CloudFormation
        code = `AWSTemplateFormatVersion: '2010-09-09'
Description: 'Auto-generated infrastructure template'

Resources:
`;
        resources.forEach((resource) => {
          const resourceName = resource.type.replace('-', '') + resource.id;
          code += `  ${resourceName}:
    Type: ${resource.cloudformation}
    Properties:
`;
          
          if (resource.type === 'ec2') {
            code += `      ImageId: ami-0c55b159cbfafe1f0
      InstanceType: t2.micro
      Tags:
        - Key: Name
          Value: ${resource.name}-${resource.id}`;
          } else if (resource.type === 's3') {
            code += `      BucketName: !Sub '\${AWS::StackName}-${resource.id}'
      Tags:
        - Key: Name
          Value: ${resource.name}-${resource.id}`;
          } else {
            code += `      # Configuration for ${resource.name}`;
          }
          
          code += `\n\n`;
        });
      }
      
      codeDisplay.innerHTML = `<code>${escapeHtml(code)}</code>`;
    }

    function escapeHtml(text) {
      const div = document.createElement('div');
      div.textContent = text;
      return div.innerHTML;
    }

    function copyCode() {
      const code = document.getElementById('generatedCode').textContent;
      navigator.clipboard.writeText(code).then(() => {
        alert('Code copied to clipboard!');
      });
    }

    function updateDependencyGraph() {
      const canvas = document.getElementById('dependencyGraph');
      const ctx = canvas.getContext('2d');
      
      canvas.width = canvas.offsetWidth;
      canvas.height = canvas.offsetHeight;
      
      // Clear canvas
      ctx.fillStyle = 'rgba(10, 10, 15, 0.5)';
      ctx.fillRect(0, 0, canvas.width, canvas.height);
      
      if (resources.length === 0) {
        ctx.fillStyle = '#a0aec0';
        ctx.font = '14px Inter';
        ctx.textAlign = 'center';
        ctx.fillText('Add resources to see dependency graph', canvas.width / 2, canvas.height / 2);
        return;
      }
      
      // Draw nodes
      const nodeRadius = 30;
      const padding = 80;
      const cols = Math.ceil(Math.sqrt(resources.length));
      const rows = Math.ceil(resources.length / cols);
      const cellWidth = (canvas.width - padding * 2) / cols;
      const cellHeight = (canvas.height - padding * 2) / rows;
      
      resources.forEach((resource, index) => {
        const col = index % cols;
        const row = Math.floor(index / cols);
        const x = padding + col * cellWidth + cellWidth / 2;
        const y = padding + row * cellHeight + cellHeight / 2;
        
        // Draw connections
        if (index > 0) {
          const prevIndex = index - 1;
          const prevCol = prevIndex % cols;
          const prevRow = Math.floor(prevIndex / cols);
          const prevX = padding + prevCol * cellWidth + cellWidth / 2;
          const prevY = padding + prevRow * cellHeight + cellHeight / 2;
          
          ctx.strokeStyle = 'rgba(0, 217, 255, 0.3)';
          ctx.lineWidth = 2;
          ctx.beginPath();
          ctx.moveTo(prevX, prevY);
          ctx.lineTo(x, y);
          ctx.stroke();
          
          // Draw arrow
          const angle = Math.atan2(y - prevY, x - prevX);
          ctx.beginPath();
          ctx.moveTo(x - nodeRadius * Math.cos(angle), y - nodeRadius * Math.sin(angle));
          ctx.lineTo(
            x - nodeRadius * Math.cos(angle) - 10 * Math.cos(angle - Math.PI / 6),
            y - nodeRadius * Math.sin(angle) - 10 * Math.sin(angle - Math.PI / 6)
          );
          ctx.lineTo(
            x - nodeRadius * Math.cos(angle) - 10 * Math.cos(angle + Math.PI / 6),
            y - nodeRadius * Math.sin(angle) - 10 * Math.sin(angle + Math.PI / 6)
          );
          ctx.closePath();
          ctx.fillStyle = 'rgba(0, 217, 255, 0.3)';
          ctx.fill();
        }
        
        // Draw node
        const gradient = ctx.createRadialGradient(x, y, 0, x, y, nodeRadius);
        gradient.addColorStop(0, 'rgba(0, 217, 255, 0.3)');
        gradient.addColorStop(1, 'rgba(168, 85, 247, 0.3)');
        
        ctx.fillStyle = gradient;
        ctx.beginPath();
        ctx.arc(x, y, nodeRadius, 0, Math.PI * 2);
        ctx.fill();
        
        ctx.strokeStyle = '#00d9ff';
        ctx.lineWidth = 2;
        ctx.stroke();
        
        // Draw icon
        ctx.font = '24px Arial';
        ctx.textAlign = 'center';
        ctx.textBaseline = 'middle';
        ctx.fillText(resource.icon, x, y);
        
        // Draw label
        ctx.font = '11px Inter';
        ctx.fillStyle = '#ffffff';
        ctx.fillText(resource.type, x, y + nodeRadius + 15);
      });
    }

    function zoomIn() {
      const canvas = document.getElementById('infrastructureCanvas');
      canvas.style.transform = canvas.style.transform ? 
        `scale(${parseFloat(canvas.style.transform.match(/scale\(([\d.]+)\)/)?.[1] || 1) * 1.2})` :
        'scale(1.2)';
    }

    function zoomOut() {
      const canvas = document.getElementById('infrastructureCanvas');
      canvas.style.transform = canvas.style.transform ?
        `scale(${parseFloat(canvas.style.transform.match(/scale\(([\d.]+)\)/)?.[1] || 1) / 1.2})` :
        'scale(0.83)';
    }

    // Initialize
    updateCode();
    updateDependencyGraph();
  </script>
</body>
</html>
